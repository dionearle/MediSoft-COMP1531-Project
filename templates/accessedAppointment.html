{% extends 'base.html' %}
{% block book_banner %}
<a class="item" href="/">
    Home
</a>
<a class="item" href="/search">
    Search
</a>
<a class="active item" href="/appointments">
    Appointments
</a>
<a class="item" href="/profile/self/{{current_user.get_id()}}">
    Profile
</a>
<a class="item" href="/history">
    History
</a>
<div class="right menu">
    <a class="ui item" href="/logout">
        Logout
    </a>
</div>
{% endblock %}
{% block accessedAppointment %}

<h2 class = "ui header">{{ appointment.patient }}'s Appointment</h2>

<form method='POST' action="/appointments">
    <div class="ui form">
        <div class="field">
            <label>Record Notes</label>
            <textarea name="notes"></textarea>
        </div>
        <div class="field">
            <label>Add Medicine</label>
            <textarea name="prescribedMedicine"></textarea>
        </div>
        <table class="table" id="table">
        	<thead>
        		<tr>
                <th scope="col">#</th>
        		<th colspan="4">Previous Appointments</th>
        	    </tr>
        	</thead>
        	<tbody>
                {% set count = [0] %}
        			{% for item in appointments[1:] %}
        			    {% if item.accessed == True %}
                        {% if count.append(count.pop() + 1) %}{% endif %}
        				<tr>
                            <th>{{ count[0] }}</th>
                            <th>Notes:</th>
                            <td>{{item.notes}}</td>
                            <th>Medicine:</th>
                            <td>{{item.prescribedMedicine}}</td>
        				</tr>
                        {% endif %}
        			{% endfor %}
        	</tbody>
        </table>
        {% if current_user.getProfession() == "GP" %}
        <div class="field">
            <label>Refer to a specialist:</label>
        </div>
        <table class="ui table" id="table">
                <thead>
            		<tr>
            			<th scope="col">Name</th>
            			<th scope="col">Expertise</th>
            			<th scope="col">Refer</th>
            		</tr>
            	</thead>
        	<tbody>
        	    {% for item in specialists %}
        	    <tr>
        	    	<td>{{ item.get_id() }} </td>
        	    	<td>{{ item.get_expertise() }} </td>
        	    	<td><div class="ui radio checkbox">
                        <input class="form-check-input" type="radio" name="radioRefer" id={{item.get_id()}} value={{item.get_id()}} unchecked>
                        <label class="form-check-label" for={{item.get_id()}}>
                        Refer this specialist
                        </label><br/>
                    </div></td>
        	    </tr>
        	    {% endfor %}
                <tr>
        	    	<td colspan="2">Select here if you don't want to refer this patient to a specialist</td>
        	    	<td><div class="ui radio checkbox">
                        <input class="form-check-input" type="radio" name="radioRefer" id="NoRefer" value="NoRefer" checked>
                        <label class="form-check-label" for="NoRefer">
                        None
                        </label><br/>
                    </div></td>
        	    </tr>
        	</tbody>
        </table>
        <div class="field">
            <label>Letter for specialist</label>
            <textarea name="specialist_letter"></textarea>
        </div>
        {% endif %}
        <input type="hidden" name="appointmentIndex" value='{{appointmentIndex}}'/>
        <input type="submit" name="submitAppointment" class="ui basic button" value="Submit appointment"/>
    </div>
</form>

{% endblock%}
